---
title: "Dojo SDK Overview"
description: "Comprehensive guide to using the Dojo SDK for building onchain applications"
---

# Dojo SDK: Build onchain faster

The Dojo SDK provides a powerful, intuitive interface for interacting with onchain state. It streamlines data fetching and subscriptions, supporting both simple and complex queries.

## Table of Contents

- [Installation](#installation)
- [Usage](#usage)
  - [Initializing the SDK](#initializing-the-sdk)
  - [Understanding Queries](#understanding-queries)
  - [Querying Entities](#querying-entities)
  - [Subscribing to Entity Changes](#subscribing-to-entity-changes)
  - [Sending Signed Messages](#sending-signed-messages)
  - [Using with Zustand](#using-with-zustand)
  - [Optimistic Client Rendering](#optimistic-client-rendering)
- [Advanced Usage](#advanced-usage)
  - [Complex Queries](#complex-queries)
- [Troubleshooting](#troubleshooting)

## Key Features

- **Type Safety**: Leverage TypeScript for robust, error-resistant code.
- **Intuitive query syntax**: Write queries that feel natural, similar to popular OrMs.
- **Flexible subscriptions**: Easily subscribe to specific state changes in your Dojo world.
- **Signed messages**: Sign off-chain state and send to torii.
- **Automatic Zustand Support**: Drop in zustand state management
- **Optimistic Client Rendering**: Set state before a transaction has resolved to improve user experiences

### Understand Entities and Models

- Entities are uniquely identified by Keys defined in associated models
- Entities can have multiple models, representing complex game states
- When a subscription or query returns data - it returns the updated Entity and changed models.

## Torii - a ECS query system powerhouse

**Before going further** be sure to read [this documentation of Torii queries](../../../toolchain/torii/grpc.md)
Torii provides a grpc server that wraps all required tools to query your entities in a performant manner.

## Example: Subscribing to Specific Model States

Here's a concise example demonstrating how to subscribe to the `item` model in the `world` namespace, specifically filtering for items with a durability of 2:

```typescript
// imports 
import {
    useDojoSDK,
    useEntityId,
    useEntityQuery,
    // useModels fetches all entities : return an array
    useModels,
    // Single model retrieval from store : useful when you know the entityId. Returns a single entity
    useModel,
} from "@dojoengine/sdk/react";
import { KeysClause, ToriiQueryBuilder } from "@dojoengine/sdk";



// inside a react component
useEntityQuery(
    new ToriiQueryBuilder()
        .withClause(
            MemberClause("world-Item", "durability", "Eq", 2).build()
        )
        .includeHashedKeys()
);

// Fetch all items from the store
const items = useModels("world-Item")

// Fetches a single item from the store
// For instance, if I know my item has an id of 1, I can fetch it like this :
const entityId = useEntityId(1)
const item = useModel(entityId, "world-Item")
```

## Usage

### ðŸš€ Installation

```bash
npm install @dojoengine/sdk
```

Generate TypeScript types directly from your world schema:

To take advantage of this type safety (You will need [dojo](https://github.com/dojoengine/dojo) installed):

1. Generate the TypeScript types for your world:

    ```bash
    sozo build --typescript
    # or if you want to specify the output directory
    sozo build --typescript --bindings-output ./desired-output-path
    ```

2. You will import these and pass into the sdk init function to give your app type. You can see all the options for sozo, like setting the output directory, with the following command:

    ```bash
    sozo build --help
    ```

This approach ensures that your code remains in sync with your Dojo world definition, catching potential issues early in the development process.

### Initializing the SDK

```typescript
import { init } from "@dojoengine/sdk";
import {
    SchemaType,
    schema,
} from "../where-you-generated-your-models/models.gen";
import { dojoConfig } from "../your-dojo-config-path";

// Initialize the SDK
const db = await init<SchemaType>(
    {
        client: {
            toriiUrl: dojoConfig.toriiUrl,
            relayUrl: dojoConfig.relayUrl,
            worldAddress: dojoConfig.manifest.world.address,
        },
        domain: {
            name: "Example",
            version: "1.0",
            chainId: "your-chain-id",
            revision: "1",
        },
    },
    schema
);
```

### Understanding Queries

[Here you can find a detailed explanation over how Torii gRPC works](../../../toolchain/torii/grpc.md)

The SDK utilizes two primary types of queries to interact with the Dojo Engine:

1. **`SubscriptionQueryType`**: Used for real-time subscriptions to entity and event updates.
2. **`QueryType`**: Used for fetching entities and event messages with more flexible filtering options.

Both query types enable filtering based on `entityIds` and specific model properties. The key difference lies in the operators supported within the `where` clause:

- **`SubscriptionQueryType`**:
  - Supports only the `$is` operator for exact matches.
- **`QueryType`**:
  - Supports a variety of operators for more advanced filtering:
  - You combine queries with 'And' with 'Or' from deep queries. See [Advanced Usage](#advanced-usage).

### Querying Entities

This example fetches `player` entities from the `world` namespace where `id` is "1" and `name` is "Alice", demonstrating multiple conditions in a query.

Note: `$eq` is for exact matching. Other operators (`$gt`, `$lt`, etc.) are available for complex queries.

```typescript
// This is how a raw Torii query would look like.
{
    "Composite": {
        "operator": "And",
        "clauses": [
            {
                "Member": {
                    "model": "world-Player",
                    "member": "id",
                    "operator": "Eq",
                    "value": {
                        "Primitive": {
                            "U32": 1
                
// OR (but only if you're a lazy ninja)
const entities = await sdk.getEntities({
    query: new ToriiQueryBuilder()
        .withClause(
            AndComposeClause([
                AndComposeClause([
                    MemberClause("world-player", "score", "Gt", 100),
                    OrComposeClause([
                        MemberClause("world-player", "name", "Eq", "Bob"),
                        MemberClause("world-player", "name", "Eq", "Alice"),
                    ]),
                ]),
                MemberClause("world-item", "durability", "Lt", 50),
            ]).build()
        )
        .build()
});
```